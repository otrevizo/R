---
title: "dyplr library vignette"
author: "Oscar A. Trevizo"
output:
  pdf_document:
    toc: yes
  html_document:
    toc: yes
---

# Purpose

This vignette aims to introduce you dplyr library. It is here for learning purposes.

- \{dplyr\} (pronounced d - plier dataset plier... pliers to trim data) 

# Libraries

- Load dpylr

Tip: Shortcut select a word and click quotations to automate.

It has several functions or methods

- Pipes %>% to chain commands



```{r setup, include=FALSE}

# This is the library we will highlight here
library(dplyr)

knitr::opts_chunk$set(echo = TRUE)
```


# Load possum dataset from DAAG

```{r}

# Add DAAG to pull some data
library(DAAG)


# For example DAAG has 'possum'

# data()

# From the console, you can do:
# > ?datasetname

data('possum')
str(possum)
summary(possum)
# Try from the console:
# > ?possum
```

## Pipes

- Mac shortcut shift-command-m for %>% (that is from {dyplr})
- To be demosntrated throughout this vignette

## SELECT

- To specific column, by column number or column 'name'


```{r}
# Select specific columns.
#
possum %>% select(2:3, 4:7)
```

## FILTER

```{r}
# This example shows a filter with multiple conditions.
#
possum %>% filter(sex == 'f', Pop == 'Vic', age < 4)
```

## ARRANGE

- A type of sort

```{r}
# Arrange, or sort
# Here we start to pipe using multiple lines.
#
possum %>% filter(sex == 'f', Pop == 'Vic', age < 4) %>% 
  arrange(desc(belly))

```

## SUMMARISE

- You can introduce functions or equations and summarise.

```{r}
# summarise() with multple functions... Avg, SD...
#
possum %>% filter(sex == 'f', Pop == 'Vic', age < 4) %>% 
  arrange(desc(belly)) %>% 
  summarise(Avg = mean(belly),
            SD = sd(belly),
            count = n())

```

## GROUP BY

- It creates a table.

```{r}
# group_by() before summarising.
#
possum %>% filter(sex == 'm') %>% 
  group_by(site) %>%
  summarise(Avg = mean(belly),
            SD = sd(belly),
            count = n())


```

## Example: arrange() on that table created by group_by()

```{r}
# Add another function, descending order
possum %>% filter(sex == 'm') %>% 
  group_by(site) %>%
  summarise(Avg = mean(belly),
            SD = sd(belly),
            count = n()) %>%
  arrange(desc(Avg))



```

## Create a new table (mutate)

```{r}
# New variable TR
mytable <- possum %>% 
  group_by(site) %>%
  summarise(TR = sum(taill) / sum(totlngth),
            count = n()) %>%
  arrange(desc(TR))

print(mytable)

```


# Load flights dataset from nycflights13 library 


# References

Dr. Bharatendra https://www.youtube.com/watch?v=rsfV57N7Uns&list=PL34t5iLfZddtUUABMikey6NtL05hPAp42&index=10

